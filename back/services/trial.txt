exports.generateByCategory = async (categoryId, mois, annee) => {
  // 1. Récupérer les agents de cette catégorie
  const agents = await db.query("SELECT * FROM agents WHERE id_categorie = $1", [categoryId]);

  for (const agent of agents.rows) {
    // 2. Vérifier s’il a déjà une fiche pour ce mois
    const ficheExist = await db.query(`
      SELECT * FROM paies 
      WHERE id_agent = $1 AND EXTRACT(MONTH FROM mois) = $2 AND EXTRACT(YEAR FROM mois) = $3
    `, [agent.id, mois, annee]);

    if (ficheExist.rows.length === 0) {
      // 3. Récupérer son chiffre d’affaires pour ce mois
      const ca = await db.query(...);

      // 4. Récupérer infos de la catégorie (bonus, seuil)
      const infos = await db.query(...);

      // 5. Calculer salaire total et bonus
      // bonus = ca > seuil ? ca * bonus% : 0

      // 6. Insérer dans paies
      await db.query("INSERT INTO paies (...) VALUES (...)", [...]);
    }
  }

  return { success: true };
};


const bonus = parseFloat(data[0].bonus);     // 0.02
const montant = parseInt(data[0].montant);   // 100000


const bonus = data[0].bonus;      // '0.02'
const montant = data[0].montant;  // '100000'

